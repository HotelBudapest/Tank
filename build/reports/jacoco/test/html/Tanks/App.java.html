<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>App.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">tanks</a> &gt; <a href="index.source.html" class="el_package">Tanks</a> &gt; <span class="el_source">App.java</span></div><h1>App.java</h1><pre class="source lang-java linenums">package Tanks;

import processing.core.PApplet;
import processing.core.PImage;
import processing.core.PVector;
import processing.data.JSONArray;
import processing.data.JSONObject;
import processing.event.KeyEvent;
import processing.event.MouseEvent;

import java.io.*;
import java.util.*;

import jogamp.graph.curve.tess.Loop;

public class App extends PApplet {

    public static final int CELLSIZE = 32; //8;
    public static final int CELLHEIGHT = 32;

    public static final int CELLAVG = 32;
    public static final int TOPBAR = 0;
<span class="fc" id="L23">    public static int WIDTH = 864; //CELLSIZE*BOARD_WIDTH;</span>
<span class="fc" id="L24">    public static int HEIGHT = 640; //BOARD_HEIGHT*CELLSIZE+TOPBAR;</span>
<span class="fc" id="L25">    public static final int BOARD_WIDTH = WIDTH/CELLSIZE;</span>
    public static final int BOARD_HEIGHT = 20;
<span class="fc" id="L27">    public int[][] board = new int[32][32];</span>
<span class="fc" id="L28">    ArrayList&lt;Integer&gt; treesLs = new ArrayList&lt;Integer&gt;();</span>
<span class="fc" id="L29">    ArrayList&lt;Integer&gt; terrainHeightsInitial = new ArrayList&lt;Integer&gt;();</span>

    public boolean isgameOver;

    public Terrain terrain;

    //ArrayList&lt;PVector&gt; test = new ArrayList&lt;PVector&gt;();
<span class="fc" id="L36">    HashMap&lt;String, Integer&gt; playerLs = new HashMap&lt;String, Integer&gt;();</span>
<span class="fc" id="L37">    ArrayList&lt;player&gt; playingOnBoard = new ArrayList&lt;player&gt;();</span>
<span class="fc" id="L38">    public HashMap&lt;String ,int[]&gt; playerColorValues = new HashMap&lt;String ,int[]&gt;();</span>
    player CurrentPlayer;
<span class="fc" id="L40">    ArrayList&lt;player&gt; backupForEndGame = new ArrayList&lt;player&gt;();</span>

    
<span class="fc" id="L43">    public static HashMap&lt;String, Integer&gt; pastPlayerScores = new HashMap&lt;String, Integer&gt;();</span>

<span class="fc" id="L45">    int turnManagerINT = 0;</span>
<span class="fc" id="L46">    int stageManagerINT = 0;</span>
<span class="fc" id="L47">    int arektaManager = 0;</span>
    float startTime;

<span class="fc" id="L50">    ArrayList&lt;Projectile&gt; projectiles = new ArrayList&lt;Projectile&gt;();</span>
<span class="fc" id="L51">    public int Wind = random.nextInt(71) - 35;</span>

    String trees;
    public PImage treepic;
    public PImage fuelIMG;
    public PImage Wind1;
    public PImage Wind2;
    player previousPlayer;

    public static PImage parachuteIMG;
    protected int R;
    protected int G;
    protected int B;

    public static final int INITIAL_PARACHUTES = 1;

    public static final int FPS = 30;

    public String configPath;
    public String backgroundImage;
    String foregroundColour;
    String layout;

<span class="fc" id="L74">    public static Random random = new Random();</span>
	
	// Feel free to add any additional methods or attributes you want. Please put classes in different files.

<span class="fc" id="L78">    public App() {</span>
<span class="fc" id="L79">        this.configPath = &quot;config.json&quot;;</span>
<span class="fc" id="L80">    }</span>

    /**
     * Initialise the setting of the window size.
     */
	@Override
    public void settings() {
<span class="fc" id="L87">        size(WIDTH, HEIGHT);</span>
<span class="fc" id="L88">    }</span>

    /**
     * Load all resources such as images. Initialise the elements such as the player, enemies and map elements.
     */
	@Override
    public void setup() {
<span class="fc" id="L95">        frameRate(FPS);</span>
        
<span class="fc" id="L97">        startTime = frameCount;</span>
<span class="fc" id="L98">        JSONObject json = loadJSONObject(configPath);</span>

<span class="fc" id="L100">        JSONArray level = json.getJSONArray(&quot;levels&quot;);</span>
<span class="fc" id="L101">        JSONObject current = level.getJSONObject(stageManagerINT%3);</span>
<span class="fc" id="L102">        layout = current.getString(&quot;layout&quot;);</span>
<span class="fc" id="L103">        backgroundImage = current.getString(&quot;background&quot;);</span>
<span class="fc" id="L104">        String[] foregroundColour = current.getString(&quot;foreground-colour&quot;).split(&quot;,&quot;);</span>
<span class="fc" id="L105">        System.out.println(Arrays.toString(foregroundColour));</span>
<span class="fc" id="L106">        R = Integer.parseInt(foregroundColour[0]);</span>
<span class="fc" id="L107">        G = Integer.parseInt(foregroundColour[1]);</span>
<span class="fc" id="L108">        B = Integer.parseInt(foregroundColour[2]);</span>
<span class="fc" id="L109">        JSONObject playerColoursJson = json.getJSONObject(&quot;player_colours&quot;);</span>
<span class="fc" id="L110">        String[] playerTypes = {&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;, &quot;E&quot;};</span>
<span class="fc bfc" id="L111" title="All 2 branches covered.">        for (String type : playerTypes) {</span>
            // Check if the type exists in the JSON
<span class="pc bpc" id="L113" title="1 of 2 branches missed.">            if (playerColoursJson.hasKey(type)) {</span>
<span class="fc" id="L114">                String colorStr = playerColoursJson.getString(type);</span>
<span class="fc" id="L115">                String[] colorComponents = colorStr.split(&quot;,&quot;);</span>
<span class="fc" id="L116">                int[] colorValues = new int[colorComponents.length];</span>
<span class="fc bfc" id="L117" title="All 2 branches covered.">                for (int k = 0; k &lt; colorComponents.length; k++) {</span>
<span class="fc" id="L118">                    colorValues[k] = Integer.parseInt(colorComponents[k]);</span>
                }
<span class="fc" id="L120">                playerColorValues.put(type, colorValues);</span>
            }
        }

<span class="pc bpc" id="L124" title="1 of 2 branches missed.">        if(current.hasKey(&quot;trees&quot;)){</span>
<span class="fc" id="L125">            treepic = loadImage(current.getString(&quot;trees&quot;));</span>
        }
        else{
<span class="nc" id="L128">            trees = null;</span>
        }

<span class="fc" id="L131">        parachuteIMG  = loadImage(&quot;src/main/resources/Tanks/parachute.png&quot;);</span>
<span class="fc" id="L132">        fuelIMG = loadImage(&quot;src/main/resources/Tanks/fuel.png&quot;);</span>
<span class="fc" id="L133">        Wind1 = loadImage(&quot;src/main/resources/Tanks/wind.png&quot;);</span>
<span class="fc" id="L134">        Wind2 = loadImage(&quot;src/main/resources/Tanks/wind-1.png&quot;);</span>

        try{ 
<span class="fc" id="L137">			BufferedReader reader = new BufferedReader(new FileReader(layout));</span>
<span class="fc" id="L138">            int i =0; </span>
            while (true){
<span class="fc" id="L140">                String line = reader.readLine();</span>
<span class="fc bfc" id="L141" title="All 2 branches covered.">                if (line == null){</span>
<span class="fc" id="L142">                    break;</span>
                }
<span class="fc" id="L144">                String[] line_sep = line.split(&quot;&quot;);</span>
<span class="fc bfc" id="L145" title="All 2 branches covered.">                for (int j = 0; j &lt; line_sep.length; j++){</span>
<span class="fc bfc" id="L146" title="All 2 branches covered.">                    if (line_sep[j].equals(&quot;X&quot;)){</span>
<span class="fc" id="L147">                        board[i][j] = 1;</span>
                    }
<span class="fc bfc" id="L149" title="All 2 branches covered.">                    else if (line_sep[j].equals(&quot;T&quot;)){</span>
<span class="fc" id="L150">                        treesLs.add(j*CELLSIZE);</span>
                    }
<span class="pc bpc" id="L152" title="1 of 10 branches missed.">                    else if ((line_sep[j].equals(&quot;A&quot;)) || line_sep[j].equals(&quot;B&quot;) || line_sep[j].equals(&quot;C&quot;) || line_sep[j].equals(&quot;D&quot;) || line_sep[j].equals(&quot;E&quot;)){ //((line_sep[j].equals(&quot;A&quot;)) || line_sep[j].equals(&quot;B&quot;) || line_sep[j].equals(&quot;C&quot;) || line_sep[j].equals(&quot;D&quot;))</span>
                        /*playerLs.add(new player(new PVector(j*10, i), &quot;A&quot;));
                        System.out.println(playerLs.get(lame).coordinates);
                        lame++;*/
<span class="fc bfc" id="L156" title="All 2 branches covered.">                        if (line_sep[j].equals(&quot;A&quot;)){</span>
<span class="fc" id="L157">                            playerLs.put(&quot;A&quot;,j*CELLSIZE);</span>
                        }
<span class="fc bfc" id="L159" title="All 2 branches covered.">                        else if (line_sep[j].equals(&quot;B&quot;)){</span>
<span class="fc" id="L160">                            playerLs.put(&quot;B&quot;,j*CELLSIZE);</span>
                        }
<span class="fc bfc" id="L162" title="All 2 branches covered.">                        else if (line_sep[j].equals(&quot;C&quot;)){   </span>
<span class="fc" id="L163">                            playerLs.put(&quot;C&quot;,j*CELLSIZE);</span>
                        }
<span class="pc bpc" id="L165" title="1 of 2 branches missed.">                        else if (line_sep[j].equals(&quot;D&quot;)){  </span>
<span class="fc" id="L166">                            playerLs.put(&quot;D&quot;,j*CELLSIZE);</span>
                        }
<span class="nc bnc" id="L168" title="All 2 branches missed.">                        else if (line_sep[j].equals(&quot;E&quot;)){  </span>
<span class="nc" id="L169">                            playerLs.put(&quot;E&quot;,j*CELLSIZE);</span>
                        }
                    }
                }
<span class="fc" id="L173">                i++;</span>
<span class="fc" id="L174">            }</span>

<span class="fc bfc" id="L176" title="All 2 branches covered.">            for (int s = 0; s &lt; board.length; s++){</span>
<span class="fc bfc" id="L177" title="All 2 branches covered.">                for (int t = 0; t &lt; board[0].length; t++){</span>
<span class="fc bfc" id="L178" title="All 2 branches covered.">                    if (board[t][s] == 1){</span>
                        /*for (float n = 0; n &lt;= 1; n+=0.1f){
                            test.add(new PVector(s + n, t));
                        }*/
<span class="fc bfc" id="L182" title="All 2 branches covered.">                        for (int b =0; b &lt; 32; b++){</span>
<span class="fc" id="L183">                            terrainHeightsInitial.add(t*CELLSIZE);</span>
                            //Terrain.widths.add((s + b));
                        }
                    }
                }
            }

<span class="fc" id="L190">            Map&lt;String, Integer&gt; sortedMap = new TreeMap&lt;&gt;(playerLs);</span>

<span class="fc" id="L192">            String[] keys = {&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;, &quot;E&quot;};</span>
<span class="fc" id="L193">            ArrayList&lt;Integer&gt; sortedplayer = new ArrayList&lt;Integer&gt;();</span>
<span class="fc bfc" id="L194" title="All 2 branches covered.">            for (String key : keys) {</span>
<span class="fc bfc" id="L195" title="All 2 branches covered.">                if (sortedMap.containsKey(key)) {</span>
<span class="fc" id="L196">                    sortedplayer.add(sortedMap.get(key));</span>
                }
            }

<span class="fc" id="L200">            terrain = new Terrain(treesLs, treepic, sortedplayer, terrainHeightsInitial);</span>
            
<span class="fc" id="L202">            terrain.smoothArray();</span>

            /*for (int j = 0; j &lt; terrain.terrainCoordinates.size(); j++){
                explosiveCoords.put(terrain.terrainCoordinates.get(j).x*CELLSIZE, terrain.terrainCoordinates.get(j).y*CELLSIZE);
            }*/
            

<span class="fc" id="L209">            int[] coordsX = terrain.getPlayerCoordsX();</span>
<span class="fc" id="L210">            float[] coordsY = terrain.getPlayerCoordsY();</span>

<span class="fc bfc" id="L212" title="All 2 branches covered.">            for (int s =0; s &lt; coordsY.length; s++){</span>
<span class="fc bfc" id="L213" title="All 2 branches covered.">                if (s == 0){</span>
<span class="fc" id="L214">                    String srt = &quot;A&quot;;</span>
<span class="fc" id="L215">                    playingOnBoard.add(new player(coordsX[s], coordsY[s], srt, playerColorValues.get(srt)));</span>
<span class="fc" id="L216">                }</span>
<span class="fc bfc" id="L217" title="All 2 branches covered.">                else if (s == 1){</span>
<span class="fc" id="L218">                    String srt = &quot;B&quot;;</span>
<span class="fc" id="L219">                    playingOnBoard.add(new player(coordsX[s], coordsY[s], srt, playerColorValues.get(srt)));</span>
<span class="fc" id="L220">                }</span>
<span class="fc bfc" id="L221" title="All 2 branches covered.">                else if (s == 2){</span>
<span class="fc" id="L222">                    String srt = &quot;C&quot;;</span>
<span class="fc" id="L223">                    playingOnBoard.add(new player(coordsX[s], coordsY[s], srt, playerColorValues.get(srt)));</span>
<span class="fc" id="L224">                }</span>
<span class="pc bpc" id="L225" title="1 of 2 branches missed.">                else if (s == 3){</span>
<span class="fc" id="L226">                    String srt = &quot;D&quot;;</span>
<span class="fc" id="L227">                    playingOnBoard.add(new player(coordsX[s], coordsY[s], srt, playerColorValues.get(srt)));</span>
<span class="fc" id="L228">                }</span>
<span class="nc bnc" id="L229" title="All 2 branches missed.">                else if (s == 4){</span>
<span class="nc" id="L230">                    String srt = &quot;E&quot;;</span>
<span class="nc" id="L231">                    playingOnBoard.add(new player(coordsX[s], coordsY[s], srt, playerColorValues.get(srt)));</span>
                }
<span class="fc" id="L233">                System.out.println(coordsX[s] + &quot; &quot; + coordsY[s] + &quot; &quot; + playingOnBoard.get(s).type);</span>
            }

<span class="fc" id="L236">            CurrentPlayer = playingOnBoard.get(0);</span>
<span class="fc" id="L237">            backupForEndGame = new ArrayList&lt;player&gt;(playingOnBoard);</span>

<span class="fc" id="L239">            reader.close();</span>

            }
<span class="nc" id="L242">            catch(FileNotFoundException e){</span>
<span class="nc" id="L243">                e.printStackTrace();</span>
            }
<span class="nc" id="L245">            catch(IOException e){</span>
<span class="nc" id="L246">                e.printStackTrace();</span>
<span class="pc" id="L247">            }</span>

<span class="fc" id="L249">    }</span>

    public void changeLevel(){
<span class="nc bnc" id="L252" title="All 2 branches missed.">        for (int i = 0; i &lt; playingOnBoard.size(); i++){</span>
<span class="nc" id="L253">            pastPlayerScores.put(playingOnBoard.get(i).type, playingOnBoard.get(i).score);</span>
        }
<span class="nc" id="L255">        System.out.println(pastPlayerScores.toString());</span>
<span class="nc" id="L256">        noLoop();</span>
<span class="nc" id="L257">        stageManagerINT++;</span>
<span class="nc bnc" id="L258" title="All 2 branches missed.">        if (stageManagerINT &gt;= 3){</span>
<span class="nc" id="L259">            sortPlayers(backupForEndGame);</span>
<span class="nc" id="L260">            isgameOver = true;</span>
<span class="nc" id="L261">            HUD.displayEndGame(this, 0);</span>
        }
<span class="nc" id="L263">        turnManagerINT = 0;</span>
<span class="nc" id="L264">        board = new int[32][32];</span>
<span class="nc" id="L265">        treesLs = new ArrayList&lt;Integer&gt;();</span>
<span class="nc" id="L266">        terrainHeightsInitial = new ArrayList&lt;Integer&gt;();</span>
<span class="nc" id="L267">        projectiles = new ArrayList&lt;Projectile&gt;();</span>
<span class="nc" id="L268">        playingOnBoard = new ArrayList&lt;player&gt;();</span>
<span class="nc" id="L269">        setup();</span>
<span class="nc bnc" id="L270" title="All 2 branches missed.">        for (int i = 0; i &lt; playingOnBoard.size(); i++){</span>
<span class="nc" id="L271">            playingOnBoard.get(i).score = pastPlayerScores.get(playingOnBoard.get(i).type);</span>
        }
<span class="nc" id="L273">        loop();</span>
<span class="nc" id="L274">    }</span>

    public void manageTurns(int n){
<span class="fc" id="L277">        CurrentPlayer = playingOnBoard.get(n%(playingOnBoard.size())); </span>
<span class="fc" id="L278">    }</span>

    /**
     * Receive key pressed signal from the keyboard.
     */
	@Override
    public void keyPressed(KeyEvent event){
<span class="pc bpc" id="L285" title="1 of 2 branches missed.">        if (key == ' '){</span>
<span class="nc" id="L286">            Projectile projToBeAdded = new Projectile(CurrentPlayer.turretCoord.x - 15, CurrentPlayer.turretCoord.y, CurrentPlayer.power, CurrentPlayer.turretAngle, CurrentPlayer.color, CurrentPlayer);</span>
<span class="nc" id="L287">            Wind += projToBeAdded.getWind();</span>
<span class="nc bnc" id="L288" title="All 2 branches missed.">            if (Wind &gt; 35){</span>
<span class="nc" id="L289">                Wind = 35;</span>
            }
<span class="nc bnc" id="L291" title="All 2 branches missed.">            else if (Wind &lt; -35){</span>
<span class="nc" id="L292">                Wind = -35;</span>
            }
<span class="nc" id="L294">            projectiles.add(projToBeAdded);</span>
<span class="nc" id="L295">            turnManagerINT++;</span>
<span class="nc" id="L296">            manageTurns(turnManagerINT);</span>
        }
<span class="pc bpc" id="L298" title="3 of 4 branches missed.">        if ((key == CODED) &amp;&amp; (!isgameOver)){</span>
<span class="nc bnc" id="L299" title="All 4 branches missed.">            if ((keyCode == LEFT) &amp;&amp; (CurrentPlayer.x - 3 &gt; 3)){ // terrain.terrainCoordinates.get(terrain.players.get(turnManagerINT%(playingOnBoard.size())) - 4).x - 0.3f, terrain.terrainCoordinates.get(terrain.players.get(turnManagerINT%(playingOnBoard.size())) - 4).y - 0.3f</span>
<span class="nc" id="L300">                CurrentPlayer.move(CurrentPlayer.x - 3, Terrain.terrainForExplosion.get(CurrentPlayer.x - 3) - 3); // </span>
<span class="nc" id="L301">                terrain.players.set(turnManagerINT%(playingOnBoard.size()), terrain.players.get(turnManagerINT%(playingOnBoard.size())) - 1);</span>
<span class="nc" id="L302">                CurrentPlayer.draw(this);</span>
            } 
<span class="nc bnc" id="L304" title="All 4 branches missed.">            else if ((keyCode == RIGHT) &amp;&amp;(CurrentPlayer.x + 3 &lt; WIDTH - 3)){</span>
<span class="nc" id="L305">                CurrentPlayer.move(CurrentPlayer.x + 3, Terrain.terrainForExplosion.get(CurrentPlayer.x + 3) - 3); // , terrain.terrainCoordinates.get(terrain.players.get(turnManagerINT%(playingOnBoard.size())) - 4).y - 0.3f</span>
<span class="nc" id="L306">                terrain.players.set(turnManagerINT%(playingOnBoard.size()), terrain.players.get(turnManagerINT%(playingOnBoard.size())) - 1);</span>
<span class="nc" id="L307">                CurrentPlayer.draw(this);</span>
            }
<span class="nc bnc" id="L309" title="All 4 branches missed.">            if ((keyCode == UP) &amp;&amp; (CurrentPlayer.turretAngle &gt; Math.toRadians(0))){</span>
<span class="nc" id="L310">                CurrentPlayer.turretAngle -= 0.1f;</span>
<span class="nc" id="L311">                float changeX = ((CurrentPlayer.x + (CurrentPlayer.x + CELLSIZE))/2) + (float)((15)*((Math.cos(CurrentPlayer.turretAngle))));</span>
<span class="nc" id="L312">                float changeY = CurrentPlayer.y - (float)((15)*((Math.sin(CurrentPlayer.turretAngle))));</span>
<span class="nc" id="L313">                CurrentPlayer.moveTurret(changeX, changeY);</span>
<span class="nc bnc" id="L314" title="All 4 branches missed.">            } else if ((keyCode == DOWN)  &amp;&amp; (CurrentPlayer.turretAngle &lt;= Math.toRadians(180))){</span>
<span class="nc" id="L315">                CurrentPlayer.turretAngle += 0.1f;</span>
<span class="nc" id="L316">                float changeX = ((CurrentPlayer.x + (CurrentPlayer.x + CELLSIZE))/2) + (float)((15)*((Math.cos(CurrentPlayer.turretAngle))));</span>
<span class="nc" id="L317">                float changeY = CurrentPlayer.y - (float)((15)*((Math.sin(CurrentPlayer.turretAngle))));</span>
<span class="nc" id="L318">                CurrentPlayer.moveTurret(changeX, changeY);</span>
                //float changeX = ((CurrentPlayer.x + (CurrentPlayer.x + 1))/2 - (2/CELLSIZE)) + (float)((0.45)*((Math.cos(CurrentPlayer.turretAngle - Math.toRadians(3)))));
                //float changeY =  CurrentPlayer.y - (float)((0.45)*((Math.sin(CurrentPlayer.turretAngle - Math.toRadians(3)))));
                //CurrentPlayer.moveTurret(changeX, changeY);
            }
        }
<span class="pc bpc" id="L324" title="2 of 4 branches missed.">        if (key == 'W' || key == 'w') {</span>
<span class="nc bnc" id="L325" title="All 2 branches missed.">            if (CurrentPlayer.power &lt; CurrentPlayer.health){</span>
<span class="nc" id="L326">                CurrentPlayer.power += 36/FPS;</span>
            }
        }
<span class="pc bpc" id="L329" title="2 of 4 branches missed.">        if (key == 'S' || key == 's') {</span>
<span class="nc bnc" id="L330" title="All 2 branches missed.">            if (CurrentPlayer.power &gt; 0){</span>
<span class="nc" id="L331">                CurrentPlayer.power -= 36/FPS;</span>
            }
        }
<span class="pc bpc" id="L334" title="2 of 4 branches missed.">        if (key == 'H' || key == 'h') {</span>
<span class="nc bnc" id="L335" title="All 2 branches missed.">            if (CurrentPlayer.score &gt;= 20){</span>
<span class="nc" id="L336">                CurrentPlayer.shield++;</span>
<span class="nc" id="L337">                CurrentPlayer.score -= 20;</span>
            }
        }
<span class="pc bpc" id="L340" title="2 of 4 branches missed.">        if (key == 'p' || key == 'P') {</span>
<span class="nc bnc" id="L341" title="All 2 branches missed.">            if (CurrentPlayer.score &gt;= 15){</span>
<span class="nc" id="L342">                CurrentPlayer.parachutesLeft++;</span>
<span class="nc" id="L343">                CurrentPlayer.score -= 15;</span>
            }
        }
<span class="pc bpc" id="L346" title="2 of 4 branches missed.">        if (key == 'F' || key == 'f') {</span>
<span class="nc bnc" id="L347" title="All 2 branches missed.">            if (CurrentPlayer.score &gt;= 10){</span>
<span class="nc" id="L348">                CurrentPlayer.fuel+=200;</span>
<span class="nc" id="L349">                CurrentPlayer.score -= 10;</span>
            }
        }
<span class="pc bpc" id="L352" title="2 of 4 branches missed.">        if (key == 'y' || key == 'Y') {</span>
            // for (int i = 65; i &lt; 65 + pastPlayerScores.size(); i++){

            // }
<span class="nc" id="L356">            sortPlayers(backupForEndGame);</span>
<span class="nc" id="L357">            isgameOver = true;</span>
        }
<span class="pc bpc" id="L359" title="2 of 4 branches missed.">        if (key == 'R' || key == 'r') {</span>
<span class="nc bnc" id="L360" title="All 2 branches missed.">            if (isgameOver){</span>
<span class="nc" id="L361">                stageManagerINT = 0;</span>
<span class="nc" id="L362">                isgameOver = false;</span>
<span class="nc" id="L363">                restartGame();</span>
            }
            else{
<span class="nc bnc" id="L366" title="All 4 branches missed.">                if ((CurrentPlayer.score &gt;= 20) &amp;&amp; (CurrentPlayer.health &lt;= 80)){</span>
<span class="nc" id="L367">                    CurrentPlayer.health+=20;</span>
<span class="nc" id="L368">                    CurrentPlayer.score -= 20;</span>
                }
            }
        }
<span class="fc" id="L372">    }</span>

    public void restartGame(){
<span class="nc" id="L375">        noLoop();</span>
<span class="nc" id="L376">        turnManagerINT = 0;</span>
<span class="nc" id="L377">        board = new int[32][32];</span>
<span class="nc" id="L378">        treesLs = new ArrayList&lt;Integer&gt;();</span>
<span class="nc" id="L379">        terrainHeightsInitial = new ArrayList&lt;Integer&gt;();</span>
<span class="nc" id="L380">        arektaManager = 0;</span>
<span class="nc" id="L381">        projectiles = new ArrayList&lt;Projectile&gt;();</span>
<span class="nc" id="L382">        playingOnBoard = new ArrayList&lt;player&gt;();</span>
<span class="nc" id="L383">        backupForEndGame = new ArrayList&lt;player&gt;();</span>
<span class="nc" id="L384">        setup();</span>
<span class="nc" id="L385">        loop();</span>
<span class="nc" id="L386">    }</span>

    /**
     * Receive key released signal from the keyboard.
     */
	@Override
    public void keyReleased(){
        
<span class="nc" id="L394">    }</span>

    @Override
    public void mousePressed(MouseEvent e) {
        //TODO - powerups, like repair and extra fuel and teleport? - or maybe leave this as an extension


<span class="nc" id="L401">    }</span>

    @Override
    public void mouseReleased(MouseEvent e) {

<span class="nc" id="L406">    }</span>

    public void sortPlayers(ArrayList&lt;player&gt; players){
<span class="nc bnc" id="L409" title="All 2 branches missed.">        for (int i = 1; i &lt; players.size(); i++) {</span>
<span class="nc" id="L410">            player current = players.get(i);</span>
<span class="nc" id="L411">            int j = i - 1;</span>
<span class="nc bnc" id="L412" title="All 4 branches missed.">            while (j &gt;= 0 &amp;&amp; players.get(j).score &lt; current.score) {</span>
<span class="nc" id="L413">                players.set(j + 1, players.get(j));</span>
<span class="nc" id="L414">                j = j - 1;</span>
            }
<span class="nc" id="L416">            players.set(j + 1, current);</span>
        }
<span class="nc" id="L418">    }</span>

    /**
     * Draw all elements in the game by current frame.
     */
	@Override
    public void draw() {
        //TODO: Check user action

<span class="pc bpc" id="L427" title="1 of 2 branches missed.">        if (isgameOver){</span>
<span class="nc bnc" id="L428" title="All 2 branches missed.">            if(((frameCount - startTime)/FPS)%1 == 0){</span>
<span class="nc" id="L429">                fill(0);</span>
<span class="nc" id="L430">                textSize(25);</span>
<span class="nc" id="L431">                text(&quot;Player &quot; + backupForEndGame.get(0).type +  &quot; Wins!&quot;, WIDTH/2 - 6 * CELLSIZE, HEIGHT/2 - 6 * CELLSIZE + 15);</span>
                
<span class="nc" id="L433">                fill(backupForEndGame.get(0).color[0], backupForEndGame.get(0).color[1], backupForEndGame.get(0).color[2], 20);</span>
<span class="nc" id="L434">                stroke(0);</span>
<span class="nc" id="L435">                rect(WIDTH/2 - 7 * CELLSIZE, HEIGHT/2 - 5 * CELLSIZE, 450, 100);</span>
<span class="nc" id="L436">                fill(0);</span>
<span class="nc" id="L437">                textSize(40);</span>
<span class="nc" id="L438">                text(&quot;Final Scores&quot;, WIDTH/2 - 5 * CELLSIZE, HEIGHT/2 - 3 * CELLSIZE);</span>
<span class="nc" id="L439">                fill(backupForEndGame.get(0).color[0], backupForEndGame.get(0).color[1], backupForEndGame.get(0).color[2], 20);</span>
<span class="nc" id="L440">                rect(WIDTH/2 - 7 * CELLSIZE, HEIGHT/2 - 2 * CELLSIZE, 450, 250);</span>
<span class="nc" id="L441">                HUD.displayEndGame(this, arektaManager%backupForEndGame.size());</span>
<span class="nc" id="L442">                arektaManager++;</span>
<span class="nc bnc" id="L443" title="All 2 branches missed.">                if (arektaManager &gt;= backupForEndGame.size()){</span>
<span class="nc" id="L444">                    noLoop();</span>
                }
            }
        }
        else{
                //background(255);
<span class="fc" id="L450">            image(loadImage(backgroundImage), 0, 0, WIDTH, HEIGHT);</span>

<span class="fc" id="L452">            fill(R, G, B);</span>
<span class="fc" id="L453">            terrain.draw(this);</span>

<span class="fc" id="L455">            terrain.drawTrees(this);</span>

<span class="fc" id="L457">            HUD.displayTEXTS(this);</span>
<span class="fc" id="L458">            HUD.displayHealthBar(this);</span>
<span class="fc" id="L459">            HUD.displayScoreBoard(this);</span>
            
            //HUD.display(this);

<span class="pc bpc" id="L463" title="1 of 2 branches missed.">            if (playingOnBoard.size() == 1){</span>
<span class="nc" id="L464">                changeLevel();</span>
            }
<span class="pc bpc" id="L466" title="1 of 2 branches missed.">            if (stageManagerINT &gt;= 3){</span>
<span class="nc" id="L467">                sortPlayers(backupForEndGame);</span>
<span class="nc" id="L468">                isgameOver = true;</span>
            }

<span class="fc bfc" id="L471" title="All 2 branches covered.">            for (int i =0; i &lt; playingOnBoard.size(); i++){</span>
<span class="fc" id="L472">                player current = playingOnBoard.get(i);</span>
<span class="fc" id="L473">                current.draw(this);</span>
<span class="fc bfc" id="L474" title="All 2 branches covered.">                if (current == CurrentPlayer){</span>
<span class="fc" id="L475">                    current.drawLine(this);</span>
                }
            }

<span class="pc bpc" id="L479" title="1 of 2 branches missed.">            for (int s = 0; s &lt; projectiles.size(); s++){</span>
<span class="nc" id="L480">                Projectile proj = projectiles.get(s);</span>
<span class="nc" id="L481">                proj.update();</span>
<span class="nc" id="L482">                proj.display(this);</span>
                //System.out.println(&quot;Projectile of: &quot; + proj.PlayerThatFired.type);
                //System.out.println(explosiveCoords.get(proj.x));
                try{
<span class="nc bnc" id="L486" title="All 2 branches missed.">                    if (proj.y &gt;= Terrain.terrainForExplosion.get((int) proj.x)) {</span>
<span class="nc" id="L487">                        explosion.alterTerrain(this, proj);</span>
<span class="nc" id="L488">                        noStroke();</span>
<span class="nc" id="L489">                        explosion.drawExplosion(this, proj.x, proj.y);</span>
<span class="nc" id="L490">                        explosion.checkPlayerCollisions(this, proj);</span>
<span class="nc" id="L491">                        projectiles.remove(s);</span>
                    }
                }
<span class="nc" id="L494">                catch(IndexOutOfBoundsException e){</span>
<span class="nc" id="L495">                    projectiles.remove(s);</span>
<span class="nc" id="L496">                }</span>
            }
            }
<span class="fc" id="L499">        }</span>
        //----------------------------------
        //display HUD:
        //----------------------------------
        //TODO

        //----------------------------------
        //display scoreboard:
        //----------------------------------
        //TODO
        
		//----------------------------------
        //----------------------------------


    public static void main(String[] args) {
<span class="nc" id="L515">        PApplet.main(&quot;Tanks.App&quot;);</span>
<span class="nc" id="L516">    }</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>